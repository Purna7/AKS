<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kloudmanager - Multi-Cloud Management Dashboard | Kloudwit Solutions</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='images/logo-icon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}?v=4.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body data-theme="dark">
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo-container">
                <img src="{{ url_for('static', filename='images/logo-icon.svg') }}" alt="kloudmanager" class="logo-icon">
                <div class="logo-text">
                    <h1>kloudmanager</h1>
                </div>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-view="dashboard">
                <span class="nav-icon">üìä</span>
                <span class="nav-text">Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-view="resources">
                <span class="nav-icon">üíª</span>
                <span class="nav-text">Resources</span>
            </a>
            <a href="#" class="nav-item" data-view="github">
                <span class="nav-icon">‚ö°</span>
                <span class="nav-text">GitHub Actions</span>
            </a>
            <a href="#" class="nav-item" data-view="providers">
                <span class="nav-icon">‚òÅÔ∏è</span>
                <span class="nav-text">Providers</span>
            </a>
            <a href="#" class="nav-item" data-view="costs">
                <span class="nav-icon">üí∞</span>
                <span class="nav-text">Costs</span>
            </a>
            <a href="#" class="nav-item" data-view="compliance">
                <span class="nav-icon">‚úÖ</span>
                <span class="nav-text">Compliance</span>
            </a>
            <a href="#" class="nav-item" data-view="alerts">
                <span class="nav-icon">üîî</span>
                <span class="nav-text">Alerts</span>
            </a>
            <a href="#" class="nav-item" data-view="settings">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-text">Settings</span>
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h2 id="page-title">Multi-Cloud Dashboard</h2>
                <p id="page-subtitle">Real-time overview of your cloud resources</p>
            </div>
            <div class="header-right">
                <button class="btn btn-secondary" onclick="refreshData()">
                    <span id="refresh-icon">üîÑ</span> Refresh
                </button>
                <div class="sync-status">
                    <span class="status-dot" id="sync-status-dot"></span>
                    <span id="sync-status-text">Syncing...</span>
                </div>
            </div>
        </header>

        <!-- Dashboard View -->
        <div id="dashboard-view" class="view-content active">
            <!-- Summary Cards -->
            <div class="summary-cards">
                <div class="summary-card card-blue" onclick="switchView('resources')" style="cursor: pointer;">
                    <div class="card-icon">üíª</div>
                    <div class="card-content">
                        <h3 id="total-resources">0</h3>
                        <p>Total Resources</p>
                    </div>
                </div>
                <div class="summary-card card-green" onclick="switchView('providers')" style="cursor: pointer;">
                    <div class="card-icon">‚òÅÔ∏è</div>
                    <div class="card-content">
                        <h3 id="total-providers">0</h3>
                        <p>Active Providers</p>
                    </div>
                </div>
                <div class="summary-card card-orange" onclick="switchView('costs')" style="cursor: pointer;">
                    <div class="card-icon">üí∞</div>
                    <div class="card-content">
                        <h3 id="total-cost">$0.00</h3>
                        <p>Cost (30 days)</p>
                    </div>
                </div>
                <div class="summary-card card-red" onclick="switchView('alerts')" style="cursor: pointer;">
                    <div class="card-icon">üîî</div>
                    <div class="card-content">
                        <h3 id="total-alerts">0</h3>
                        <p>Active Alerts</p>
                    </div>
                </div>
            </div>

            <!-- Resource Distribution -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Resource Distribution by Type</h3>
                    </div>
                    <div class="card-body">
                        <div class="resource-stats">
                            <div class="stat-item">
                                <div class="stat-label">
                                    <span class="stat-icon">üñ•Ô∏è</span>
                                    <span>Virtual Machines</span>
                                </div>
                                <div class="stat-value">
                                    <span id="vm-count">0</span>
                                    <div class="stat-bar">
                                        <div class="stat-bar-fill" id="vm-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">
                                    <span class="stat-icon">üíæ</span>
                                    <span>Storage</span>
                                </div>
                                <div class="stat-value">
                                    <span id="storage-count">0</span>
                                    <div class="stat-bar">
                                        <div class="stat-bar-fill" id="storage-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">
                                    <span class="stat-icon">üåê</span>
                                    <span>Networks</span>
                                </div>
                                <div class="stat-value">
                                    <span id="network-count">0</span>
                                    <div class="stat-bar">
                                        <div class="stat-bar-fill" id="network-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">
                                    <span class="stat-icon">üóÑÔ∏è</span>
                                    <span>Databases</span>
                                </div>
                                <div class="stat-value">
                                    <span id="database-count">0</span>
                                    <div class="stat-bar">
                                        <div class="stat-bar-fill" id="database-bar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Resource Status</h3>
                    </div>
                    <div class="card-body">
                        <div class="status-grid">
                            <div class="status-item status-running" onclick="switchView('resources')" style="cursor: pointer;">
                                <div class="status-value" id="running-count">0</div>
                                <div class="status-label">Running</div>
                            </div>
                            <div class="status-item status-stopped" onclick="switchView('resources')" style="cursor: pointer;">
                                <div class="status-value" id="stopped-count">0</div>
                                <div class="status-label">Stopped</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card card-full">
                    <div class="card-header">
                        <h3>Cloud Providers Overview</h3>
                    </div>
                    <div class="card-body">
                        <div class="providers-grid" id="providers-grid">
                            <!-- Provider cards will be inserted here -->
                        </div>
                    </div>
                </div>

                <div class="dashboard-card card-full">
                    <div class="card-header">
                        <h3>‚ö° GitHub Actions Status</h3>
                        <button class="btn btn-sm btn-primary" onclick="loadGitHubActions()" style="margin-left: auto;">
                            <span id="github-refresh-icon">üîÑ</span> Refresh
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="github-actions-dashboard" class="github-dashboard">
                            <div class="github-empty-state">
                                <p>Click "Discover Actions" in the Providers section to load GitHub Actions</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card card-full">
                    <div class="card-header">
                        <h3>Recent Alerts</h3>
                    </div>
                    <div class="card-body">
                        <div id="alerts-list" class="alerts-list">
                            <!-- Alerts will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resources View -->
        <div id="resources-view" class="view-content">
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>All Cloud Resources</h3>
                    <div class="header-actions">
                        <button id="refresh-all-vms-btn" class="btn-action" onclick="refreshAllVMs()" title="Refresh all Azure VM statuses">
                            üîÑ Refresh All VMs
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-type="all">All</button>
                        <button class="filter-btn" data-type="VM">VMs</button>
                        <button class="filter-btn" data-type="Storage">Storage</button>
                        <button class="filter-btn" data-type="Network">VNets</button>
                        <button class="filter-btn" data-type="NSG">NSGs</button>
                        <button class="filter-btn" data-type="PublicIP">Public IPs</button>
                        <button class="filter-btn" data-type="LoadBalancer">Load Balancers</button>
                        <button class="filter-btn" data-type="AppService">App Services</button>
                        <button class="filter-btn" data-type="FunctionApp">Function Apps</button>
                        <button class="filter-btn" data-type="SQLServer">SQL Servers</button>
                        <button class="filter-btn" data-type="SQLDatabase">SQL DBs</button>
                        <button class="filter-btn" data-type="Disk">Disks</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-container">
                        <table class="data-table" id="resources-table">
                            <thead>
                                <tr>
                                    <th>Resource Name</th>
                                    <th>Type</th>
                                    <th>Provider</th>
                                    <th>Region</th>
                                    <th>Status</th>
                                    <th>Size</th>
                                    <th>Last Updated</th>
                                </tr>
                            </thead>
                            <tbody id="resources-table-body">
                                <!-- Resources will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination-controls">
                        <div class="pagination-info">
                            Showing <span id="page-start">0</span> to <span id="page-end">0</span> of <span id="total-resources">0</span> resources
                        </div>
                        <div class="pagination-buttons">
                            <button id="first-page" class="pagination-btn" onclick="goToPage(1)">First</button>
                            <button id="prev-page" class="pagination-btn" onclick="previousPage()">Previous</button>
                            <span class="pagination-current">Page <span id="current-page">1</span> of <span id="total-pages">1</span></span>
                            <button id="next-page" class="pagination-btn" onclick="nextPage()">Next</button>
                            <button id="last-page" class="pagination-btn" onclick="goToLastPage()">Last</button>
                        </div>
                        <div class="pagination-size">
                            <label>Show:</label>
                            <select id="page-size" onchange="changePageSize()">
                                <option value="5">5</option>
                                <option value="10" selected>10</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                            <span>per page</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GitHub Actions View -->
        <div id="github-view" class="view-content">
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>‚ö° GitHub Actions Management</h3>
                    <div style="display: flex; gap: 10px; margin-left: auto;">
                        <button class="btn btn-primary" onclick="testConnection('GitHub')">Test Connection</button>
                        <button class="btn btn-success" onclick="discoverGitHubResources()">Discover Actions</button>
                        <button class="btn btn-info" onclick="loadGitHubUsageStats()">View Statistics</button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="github-main-status" class="connection-status"></div>
                    <div id="github-usage-stats" style="margin-top: 20px;"></div>
                </div>
            </div>

            <div class="dashboard-card" style="margin-top: 20px;">
                <div class="card-header">
                    <h3>üì¶ All GitHub Actions & Workflows</h3>
                    <div style="display: flex; gap: 10px; align-items: center; margin-left: auto;">
                        <label for="repo-filter" style="font-size: 14px; font-weight: 500; color: var(--text-secondary);">Filter:</label>
                        <select id="repo-filter" class="repo-filter-select" onchange="filterGitHubActionsByRepo()">
                            <option value="all">üîç All Repositories</option>
                        </select>
                        <button class="btn btn-sm btn-primary" onclick="loadGitHubActionsView()">
                            <span id="github-view-refresh-icon">üîÑ</span> Refresh
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="github-actions-main-view" class="github-dashboard">
                        <div class="github-empty-state">
                            <p>Click "Discover Actions" above to load GitHub Actions</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Providers View -->
        <div id="providers-view" class="view-content">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>AWS Configuration</h3>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary" onclick="testConnection('AWS')">Test Connection</button>
                        <div id="aws-status" class="connection-status"></div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Azure Configuration</h3>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary" onclick="testConnection('Azure')">Test Connection</button>
                        <div id="azure-status" class="connection-status"></div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>GCP Configuration</h3>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary" onclick="testConnection('GCP')">Test Connection</button>
                        <div id="gcp-status" class="connection-status"></div>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>‚ö° GitHub Actions</h3>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary" onclick="testConnection('GitHub')">Test Connection</button>
                        <button class="btn btn-success" onclick="discoverGitHubResources()" style="margin-left: 10px;">Discover Actions</button>
                        <div id="github-status" class="connection-status"></div>
                        <div id="github-stats" style="margin-top: 15px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Costs View -->
        <div id="costs-view" class="view-content">
            <!-- Cost Summary Card -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>üí∞ Cost Overview - Last 30 Days</h3>
                </div>
                <div class="card-body">
                    <div class="cost-summary">
                        <div class="cost-card">
                            <div class="cost-label">Total Cost</div>
                            <div class="cost-value" id="total-cost">$0.00</div>
                        </div>
                        <div class="cost-card">
                            <div class="cost-label">Period</div>
                            <div class="cost-period" id="cost-period">-</div>
                        </div>
                    </div>
                    <div class="cost-breakdown">
                        <h4>Cost by Service</h4>
                        <div id="cost-by-service" class="cost-list">
                            <!-- Cost by service will be populated here -->
                        </div>
                    </div>
                    <div class="cost-breakdown">
                        <h4>Top Resources by Cost</h4>
                        <div id="cost-by-resource" class="cost-list">
                            <!-- Cost by resource will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compliance View -->
        <div id="compliance-view" class="view-content">
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>‚úÖ Compliance Status</h3>
                    <span class="compliance-count" id="compliance-count">0 Non-Compliant Resources</span>
                </div>
                <div class="card-body">
                    <div class="table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Resource Name</th>
                                    <th>Type</th>
                                    <th>Resource Group</th>
                                    <th>Location</th>
                                    <th>Policy Assignment</th>
                                    <th>Policy Definition</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="compliance-table-body">
                                <!-- Non-compliant resources will be populated here -->
                            </tbody>
                        </table>
                        <div id="compliance-empty" class="empty-state" style="display: none;">
                            <div class="empty-icon">‚úÖ</div>
                            <p>All resources are compliant!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alerts View -->
        <div id="alerts-view" class="view-content">
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>All System Alerts</h3>
                </div>
                <div class="card-body">
                    <div id="all-alerts-list" class="alerts-list-full">
                        <!-- All alerts will be inserted here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings View -->
        <div id="settings-view" class="view-content">
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>‚öôÔ∏è Application Settings</h3>
                </div>
                <div class="card-body">
                    <div class="settings-section">
                        <h4>Appearance</h4>
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Theme</div>
                                <div class="setting-description">Choose between dark and light theme</div>
                            </div>
                            <div class="setting-control">
                                <div class="theme-toggle">
                                    <button class="theme-btn" data-theme="dark" onclick="setTheme('dark')">
                                        <span class="theme-icon">üåô</span>
                                        <span>Dark</span>
                                    </button>
                                    <button class="theme-btn" data-theme="light" onclick="setTheme('light')">
                                        <span class="theme-icon">‚òÄÔ∏è</span>
                                        <span>Light</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h4>About</h4>
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Product</div>
                                <div class="setting-description">kloudmanager - Enterprise Multi-Cloud Management Platform</div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Organization</div>
                                <div class="setting-description">Kloudwit Solutions Pvt Ltd</div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Version</div>
                                <div class="setting-description">1.0.0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h4>General</h4>
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Auto Refresh</div>
                                <div class="setting-description">Automatically refresh dashboard data</div>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="auto-refresh-toggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GitHub Action Logs Modal -->
    <div id="github-logs-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="modal-workflow-title">‚ö° Workflow Runs</h3>
                <button class="modal-close" onclick="closeGitHubLogsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-workflow-info" class="workflow-info-section"></div>
                <div id="modal-runs-list" class="runs-list-section">
                    <div class="loading">Loading workflow runs...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}?v=4.0"></script>
</body>
</html>
